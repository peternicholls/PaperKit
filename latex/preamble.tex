% ==============================================================================
% Preamble: Document class, packages, and core configuration
% ==============================================================================

\documentclass[12pt,a4paper,twoside,openany]{report}

% ==============================================================================
% Character Encoding and Fonts
% ==============================================================================
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[english]{babel}

% ==============================================================================
% Mathematics and Symbols
% ==============================================================================
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{physics}

% ==============================================================================
% Graphics and Colors
% ==============================================================================
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,positioning}

% ==============================================================================
% Page Geometry and Spacing
% ==============================================================================
\usepackage[
  left=1in,
  right=1in,
  top=1in,
  bottom=1in,
  headheight=15pt
]{geometry}

\usepackage{setspace}
\onehalfspacing

% Paragraph spacing
\setlength{\parindent}{0.5in}
\setlength{\parskip}{6pt plus 2pt minus 1pt}

% ==============================================================================
% Bibliography and Citations (Harvard style)
% ==============================================================================
\usepackage[backend=bibtex,style=authoryear,natbib=true]{biblatex}
\addbibresource{references/references.bib}
\setlength\bibitemsep{1.5\itemsep}

% ==============================================================================
% Cross-references and Hyperlinks
% ==============================================================================
\usepackage{hyperref}
\hypersetup{
  colorlinks=true,
  linkcolor=blue,
  citecolor=blue,
  urlcolor=blue,
  bookmarksnumbered=true,
  pdfstartview={FitH}
}

\usepackage{cleveref}
\crefformat{section}{Section~#2#1#3}
\crefformat{subsection}{Subsection~#2#1#3}
\crefformat{figure}{Figure~#2#1#3}
\crefformat{table}{Table~#2#1#3}
\crefformat{equation}{Eq.~#2#1#3}

% ==============================================================================
% Headers and Footers
% ==============================================================================
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\leftmark}
\fancyhead[R]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}

\fancypagestyle{plain}{%
  \fancyhf{}%
  \fancyhead[R]{\thepage}%
  \renewcommand{\headrulewidth}{0pt}%
}

% ==============================================================================
% Tables and Lists
% ==============================================================================
\usepackage{booktabs}
\usepackage{array}
\usepackage{longtable}
\usepackage{enumitem}

% ==============================================================================
% Decision Rationale Boxes
% ==============================================================================
\usepackage[most]{tcolorbox}
\newtcolorbox{designdecision}[1][]{%
  colback=blue!5!white,%
  colframe=blue!75!black,%
  fonttitle=\bfseries,%
  title={Design Decision: #1}%
}

\setlist[itemize]{leftmargin=*,topsep=6pt,itemsep=3pt,partopsep=3pt}
\setlist[enumerate]{leftmargin=*,topsep=6pt,itemsep=3pt,partopsep=3pt}

% ==============================================================================
% Algorithms and Code
% ==============================================================================
\usepackage{listings}
\usepackage{xcolor}

\lstset{
  basicstyle=\ttfamily\small,
  breaklines=true,
  commentstyle=\color{gray},
  keywordstyle=\color{blue},
  numberstyle=\tiny\color{gray},
  stringstyle=\color{red},
  showstringspaces=false,
  frame=single,
  backgroundcolor=\color{white},
  captionpos=b
}

% ==============================================================================
% Theorem Environments
% ==============================================================================
\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}

% ==============================================================================
% Custom Macros and Commands
% ==============================================================================

% Common mathematical notations
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\E}{\mathbb{E}}

% Probability and statistics
\newcommand{\Prob}[1]{\mathbb{P}\left(#1\right)}
\newcommand{\Var}[1]{\text{Var}\left(#1\right)}
\newcommand{\Cov}[1]{\text{Cov}\left(#1\right)}
\newcommand{\E}[1]{\mathbb{E}\left[#1\right]}

% Operators
\DeclareMathOperator{\argmin}{argmin}
\DeclareMathOperator{\argmax}{argmax}

% Abbreviations used in this paper
\newcommand{\ie}{\textit{i.e.}}
\newcommand{\eg}{\textit{e.g.}}
\newcommand{\etal}{\textit{et al.}}

% ==============================================================================
% Footnote Configuration
% ==============================================================================
\interfootnotelinepenalty=10000

% ==============================================================================
% Section Numbering
% ==============================================================================
\setcounter{tocdepth}{2}
\setcounter{secnumdepth}{3}

% ==============================================================================
% End of Preamble
% ==============================================================================
